## X-NUCA4

分类：脚本开发

## write-up

此题需要获取flag的前提条件是$v1，$v2，$v3都为真的情况才行。初始化状态时，$v1=0;$v2=0;$v3=0，且传入的是json格式。

$v1判断条件：1.$a['bar1']非数字；2.$a['bar1']非严格比较大于2016。

$v2判断条件：1.$a['bar2']为数组；2.$a['bar2']数组长度为5；3.$a\['bar2'\]\[0\]为数组；4.$a['a2']数组中存在值nudt；5.$a['bar2']数组中不存在nutd。

$v3判断条件：1.strcmp($c[1],$d)相等且$c[1] !== $d；2.eregi函数匹配不到`3|1|c`；3.$c[0].$d中存在htctf2016

`payload:?foo={"bar1":"2017ctfhub","bar2":[[1],2,3,4,5],"a2":["nudt"]}&cat[0]=%00htctf2016&cat[1][]=a&dog=a`